from __future__ import absolute_import
import unittest
import numpy as np

from tests.sample_data import SampleData
from pyti import directional_indicators


class TestDirectionalIndicators(unittest.TestCase):
    def setUp(self):
        """Create data to use for testing."""
        self.close_data = SampleData().get_sample_close_data()
        self.high_data = SampleData().get_sample_high_data()
        self.low_data = SampleData().get_sample_low_data()

        self.positive_directional_movement_expected = [0, 10.389999999999986,
        1.9500000000000455, 5.6299999999999955, 0, 1.92999999999995,
        2.6100000000000136, 2.6200000000000045, 0, 0, 6.409999999999968,
        1.9300000000000637, 0, 0, 2.4200000000000728, 0, 0, 0,
        2.2999999999999545, 0, 0, 11.530000000000086, 13.739999999999895, 0, 0,
        0, 5.439999999999941, 0, 0, 9.81000000000006, 0, 0, 0,
        18.379999999999995, 8.43999999999994, 25.600000000000023,
        6.1299999999999955, 0, 0, 0.34000000000003183, 6.659999999999968,
        17.519999999999982, 3.9500000000000455, 9.620000000000005, 0,
        4.9500000000000455, 6.67999999999995, 6.899999999999977, 0, 0,
        4.769999999999982, 0, 0, 0, 0, 7.8700000000000045, 0, 4.310000000000059,
        0, 2.509999999999991, 0, 1.6499999999999773, 0, 3.5699999999999363, 0,
        7.279999999999973, 0.20000000000004547, 0, 12.670000000000073,
        0.67999999999995, 0, 0, 0, 2.2100000000000364, 3.599999999999909, 0, 0,
        9.470000000000027, 0, 14.670000000000073, 5.009999999999991,
        0.36000000000001364, 0, 0, 0, 1.490000000000009, 4.1099999999999, 0, 0,
        2.1000000000000227, 2.7200000000000273, 0.5099999999999909,
        2.8799999999999955, 3.6299999999999955, 2.67999999999995, 0,
        4.1099999999999, 1.1200000000000045, 1.25, 0.6200000000000045, 0, 0,
        1.2099999999999227, 0, 1.740000000000009, 0.9099999999999682,
        1.2300000000000182, 0, 0, 0, 0, 0, 1.3100000000000591, 0,
        2.6299999999999955, 0, 0, 0, 0.16999999999995907, 0, 2.7000000000000455,
        0, 0, 0, 1.9099999999999682, 0, 5.7000000000000455]

        self.negative_directional_movement_expected = [0, 0, 0, 0,
        2.1700000000000728, 0, 0, 0, 2.240000000000009, 2.8600000000000136, 0,
        0, 2.439999999999941, 7.600000000000023, 0, 14.430000000000064,
        4.209999999999923, 14.6400000000001, 0, 13.569999999999936,
        0.6399999999999864, 0, 0, 3.240000000000009, 5.5, 1.3199999999999363, 0,
        0, 9.350000000000023, 0, 5.8599999999999, 5.440000000000055,
        21.75999999999999, 0, 0, 0, 0, 10.100000000000023, 21.129999999999995,
        0, 0, 0, 0, 0, 2.730000000000018, 0, 0, 0, 11.100000000000023,
        2.5299999999999727, 0, 5.399999999999977, 15.5, 1.7100000000000364,
        1.080000000000041, 0, 2.1200000000000045, 0, 13.170000000000073, 0,
        0.9800000000000182, 0, 2.3899999999999864, 0, 1.7900000000000773, 0, 0,
        7.57000000000005, 0, 0, 10.839999999999918, 5.490000000000009,
        3.9700000000000273, 0, 0, 10.419999999999959, 1.9800000000000182, 0,
        10.120000000000005, 0, 0, 0, 10.709999999999923, 6.050000000000068,
        1.759999999999991, 0, 0, 3.1299999999999955, 1.4800000000000182, 0, 0,
        0, 0, 0, 0, 3.689999999999941, 0, 0, 0, 0, 1.7000000000000455,
        2.1100000000000136, 0, 9.81000000000006, 0, 0, 0, 9.040000000000077,
        25.879999999999995, 3.6499999999999773, 4.82000000000005, 0, 0,
        4.710000000000036, 0, 3.3799999999999955, 0.6399999999999864,
        17.360000000000014, 0, 6.349999999999909, 0, 5.340000000000032,
        9.17999999999995, 10.670000000000073, 0, 3.67999999999995, 0]

        self.pdi_period_6_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        17.17245993, 22.34368913, 23.57568532, 21.3664846 , 18.68190766,
        30.78607353, 29.69853337, 24.57613861, 19.41692593, 20.31205509,
        12.95026625,  8.63862852,  5.43198116,  5.79388242,  4.02329203,
        3.22520994,  9.9921133 , 17.18109472, 14.40626259, 12.06687531,
        10.0985882 , 12.9820837 , 11.9385369 , 10.94301187, 19.04670199,
        17.10645221, 15.10913495, 10.63037333, 22.45714669, 23.2089878 ,
        31.23989143, 25.06202808, 18.48205104, 15.20424809, 13.17587555,
        14.38245103, 20.61384189, 19.63889159, 20.6313393 , 16.97525788,
        16.60891728, 18.05079377, 19.22459986, 17.22893117, 15.32039154,
        17.03163344, 15.31391622, 12.2956512 , 10.38441109,  8.72022651,
        12.83032279, 11.19141574, 13.76350945, 12.17356566, 12.96181227,
        11.30953289, 11.43545029,  9.83177567, 13.57862577, 12.91268391,
        21.26366754, 18.42660118, 15.66738138, 31.02761477, 26.20788376,
        21.42953827, 16.92693481, 12.81773976, 12.35104846, 13.45005333,
        11.38708826,  9.83313238, 19.10158785, 16.29690792, 30.51435893,
        29.48650644, 23.8610897 , 19.17796695, 15.5221913 , 12.799587  ,
        11.99985872, 13.83323059, 12.80809723, 11.90756706, 13.71799765,
        16.59868988, 15.92326873, 18.45930389, 20.88960736, 21.22000487,
        18.19837649, 22.26908561, 21.35843931, 20.911531  , 19.21386894,
        16.50609783, 15.3470583 , 17.0388589 , 12.89321658, 13.47788976,
        12.570757  , 12.59568964,  9.29785548,  5.44570513,  3.50887115,
        2.38033623,  1.71604366,  2.1623727 ,  1.99498727,  3.89315676,
        3.69393546,  3.47303828,  2.71515231,  2.34616071,  1.80983659,
        3.63000195,  2.90280805,  2.48823796,  1.95703675,  2.99310996,
        2.40886917,  6.09048059]

        self.pdi_period_8_expected =  [np.nan, np.nan, np.nan, np.nan, np.nan,
        np.nan, np.nan, 12.84476524, 13.96304263, 13.55268862,
        21.45098964, 21.60062608, 19.73122073, 17.17602708, 18.19149004,
        13.01014933,  9.49887776,  6.380009  ,  6.03799823,  4.41258806,
        3.48581839,  7.56583328, 12.2591115 , 10.88751608,  9.73831828,
        8.6864877 , 10.13572008,  9.00038007,  8.43561508, 12.89859492,
        12.19732074, 11.42117359,  9.32564335, 17.32057505, 18.67369813,
        25.58091393, 22.10649176, 17.53458861, 14.1852722 , 11.74850059,
        12.33811672, 16.61062459, 16.23226351, 17.32367098, 15.16910778,
        14.76135521, 14.70915491, 14.68981437, 13.28379614, 12.14923166,
        13.04729963, 12.14590806, 10.80378591,  9.5095975 ,  8.34765736,
        10.7302867 ,  9.7082254 , 10.594433  ,  9.61971968, 10.1958856 ,
        9.50345605,  9.70219954,  8.94750232, 10.33102091,  9.44928437,
        13.66391887, 12.81202149, 11.83017472, 20.07584789, 18.21899147,
        16.33282596, 14.28013273, 12.07487794, 11.87595887, 12.7004416 ,
        10.5191214 ,  8.6957451 , 13.93208101, 12.72613563, 21.69167286,
        22.22874858, 19.50558145, 16.9222296 , 14.69757703, 12.77779333,
        12.1085504 , 13.38348903, 11.75411621, 10.31843813, 11.32121047,
        12.86483312, 12.52305946, 14.16633928, 16.00642705, 16.3895316 ,
        14.2861356 , 16.44414651, 15.87543075, 15.35793012, 14.61632587,
        13.48522723, 12.38948681, 12.7451686 , 11.08734197, 11.65588668,
        11.19721034, 11.16458894,  9.22205285,  6.12259108,  4.31082792,
        3.25191814,  2.53744095,  2.63369749,  2.1140582 ,  2.87420126,
        2.71562928,  2.59996554,  2.29828068,  2.11335075,  1.80843654,
        2.86489709,  2.46142161,  2.06507807,  1.66905275,  2.27104756,
        1.97768954,  4.15227219]

        self.pdi_period_10_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        np.nan, np.nan, np.nan, np.nan,  9.23796092,
        15.5995123 , 16.40825818, 15.90888348, 14.90895578, 16.1807485 ,
        12.28384969,  9.44483311,  6.68153207,  6.22348195,  4.67433429,
        3.68787643,  6.75746194,  9.99991825,  8.62772646,  7.85688094,
        7.23360865,  8.39261652,  7.73922191,  7.11879706,  9.81349491,
        9.38208089,  8.91130174,  7.82816511, 13.48221055, 14.88002142,
        20.59742968, 18.77397222, 15.70234562, 13.29192855, 11.44190072,
        11.41683073, 13.85433948, 13.48620514, 14.48624857, 13.18851537,
        13.0821946 , 13.19017287, 13.11744946, 11.56230575, 10.35806537,
        10.73320087, 10.07749647,  9.36513023,  8.63366317,  7.93337868,
        9.33499044,  8.54933336,  9.19910811,  8.50945759,  8.58747767,
        8.04623548,  8.2305099 ,  7.84340488,  8.74270827,  8.28512284,
        10.7358965 , 10.20131258,  9.7341179 , 14.90397082, 14.12850872,
        13.06025751, 12.01211781, 10.78861374, 10.78457648, 11.46714592,
        10.06039425,  8.78167148, 11.99825462, 10.53672855, 16.42508872,
        17.25684654, 15.8554005 , 14.40064092, 13.06836317, 11.85021947,
        11.45372658, 12.35840495, 11.18484707, 10.18551662, 10.30943542,
        10.73443819, 10.59925334, 11.63618884, 12.86881587, 13.37773238,
        12.2448139 , 13.65021225, 13.02220293, 12.62069281, 12.0621268 ,
        11.15607388, 10.48568678, 10.80393103,  9.91731286, 10.38219181,
        10.18796769, 10.25310323,  8.94502008,  6.61354932,  5.05227241,
        3.93469587,  3.15677541,  3.13416339,  2.62786862,  3.08810535,
        2.63328955,  2.32763682,  2.1118975 ,  1.99106827,  1.80419988,
        2.48943087,  2.23677705,  1.96527941,  1.67833889,  1.99976772,
        1.73597824,  3.16818521]

        self.ndi_period_6_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        2.5923733 ,  2.6739039 ,  2.25765683,  6.42575461, 11.48554738,
        10.26052582,  8.49297409, 12.32086135, 25.36417281, 20.29206827,
        34.73464475, 28.26067756, 31.12756748, 22.68505435, 24.77501448,
        20.26984538, 16.77397286, 14.0828462 , 13.89447581, 15.19756665,
        13.57650704, 12.28982335, 11.30192293, 18.37189092, 16.63853606,
        20.82543767, 24.18118692, 36.55775221, 26.96984518, 20.51573288,
        14.08388656,  9.90425555, 11.8138514 , 19.03283368, 16.30087656,
        13.95802082, 11.90470381, 10.22183058,  8.33364214,  8.15137653,
        6.84043491,  6.04184767,  5.22232067, 10.94683579, 11.25833631,
        10.21637339, 13.00820144, 21.01492078, 18.9302344 , 16.64870457,
        13.96340564, 13.73522997, 12.61462794, 22.46058077, 19.72608661,
        18.13966186, 15.73301658, 15.95717761, 15.27139134, 16.90803792,
        14.64139151, 12.49261706, 21.57404737, 17.77263493, 14.46770852,
        26.69003336, 28.21580466, 26.05366008, 20.17610312, 15.87778011,
        24.41167997, 23.24020572, 19.9699335 , 28.69200178, 23.94103206,
        18.85174348, 15.01552561, 22.82595723, 24.37690436, 21.80016034,
        18.00950344, 14.90040717, 17.10037193, 17.64106934, 16.26847628,
        15.0253795 , 13.68514299, 11.81598791,  9.64768734,  7.86075892,
        12.69203057, 10.80763685,  9.42804572,  8.23333447,  7.10779159,
        9.38798882, 13.27361589, 12.24206696, 30.49859454, 23.60634101,
        18.93331113, 15.45858494, 26.59318714, 46.12312506, 33.05005186,
        26.00140554, 18.74506069, 14.86703641, 16.90599333, 15.92742851,
        18.05892823, 17.60847835, 29.78412757, 24.06789591, 23.82543514,
        19.24759256, 19.50619078, 23.99595546, 26.85455429, 21.8925964 ,
        20.21998448, 17.00298171]

        self.ndi_period_8_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        np.nan, np.nan,  1.21688582,  3.6523134 ,  6.84422655,
        6.67236319,  5.93459491,  8.74888223, 17.92815525, 15.5833363 ,
        27.0423641 , 23.61411971, 26.19126936, 19.2041072 , 20.73615841,
        16.66633071, 13.47000474, 11.76734413, 11.80296643, 12.90355561,
        12.08392381, 10.75289478,  9.54842272, 13.44459518, 12.54287699,
        15.107347  , 17.37111957, 26.22212362, 21.68289548, 18.10542083,
        13.92080741, 10.74052326, 12.05854934, 16.60111117, 13.62839176,
        11.95754495, 10.77060681,  9.69826919,  8.49296382,  8.31953497,
        7.22458845,  6.17420613,  5.27895004,  8.28742006,  8.41671015,
        7.87038747,  9.35809862, 14.25166666, 13.20230156, 12.00598228,
        10.90010644, 10.73968639,  9.68530271, 14.62658584, 13.69421725,
        13.25888059, 12.30382905, 12.6952261 , 11.65872485, 11.77168431,
        11.01740856, 10.21734746, 15.04013251, 13.38816717, 11.80558415,
        19.01515414, 20.89236945, 20.64784621, 17.5504017 , 14.98186856,
        19.42956968, 17.32205934, 15.48472888, 21.01492869, 18.90822611,
        16.36141671, 14.17589493, 19.55761812, 21.05688828, 19.48296367,
        16.95233747, 14.89612456, 15.17980001, 14.32058763, 13.58779091,
        12.86541632, 12.09151368, 11.18703315, 10.01320582,  8.72321242,
        10.95756392,  9.71079804,  8.74810105,  7.79788081,  7.10484381,
        8.35717042, 10.02671206,  9.17472225, 19.33394357, 16.83178092,
        14.6630253 , 12.78095517, 20.3023948 , 34.64724347, 26.79695286,
        22.94956335, 17.90732713, 14.31330591, 13.48644276, 11.43919777,
        12.30830834, 12.0948933 , 19.2088228 , 16.95977826, 17.58724412,
        15.25719286, 15.62537469, 17.258048  , 18.40252711, 16.19716284,
        15.64280003, 13.81978726]

        self.ndi_period_10_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        np.nan, np.nan, np.nan, np.nan,  4.15544868,
        4.61551901,  4.35605974,  6.51930975, 13.55562287, 12.50272501,
        21.71288972, 19.74078936, 22.29138346, 17.05357195, 18.2833707 ,
        14.65125133, 12.04619319, 10.30454995,  9.84438834, 10.60316774,
        10.16426734,  9.39949145,  8.6677081 , 11.03849605, 10.13090354,
        11.76684573, 13.21549775, 19.57031502, 17.24535171, 15.23684361,
        12.61267555, 10.38533088, 11.46368108, 15.16922417, 12.96261451,
        11.16143402,  9.67030469,  8.78395402,  7.98972071,  7.91110403,
        7.15131082,  6.36397621,  5.57749269,  7.36992742,  7.15901389,
        6.66761238,  7.54300977, 10.81162599, 10.39681026,  9.83055575,
        9.0176576 ,  8.82274091,  8.26201493, 11.38982632, 10.51383451,
        10.14891803,  9.70923546, 10.06984929,  9.56951005,  9.74919128,
        9.21322642,  8.68271498, 11.64010235, 10.86078492, 10.06133242,
        14.5663087 , 16.12267122, 16.44722376, 14.77508562, 13.27545126,
        16.66119448, 15.46760333, 13.55351659, 16.38976002, 15.1542872 ,
        13.79236112, 12.53838876, 16.4170659 , 17.76276337, 16.94664006,
        15.35619125, 13.90608578, 14.1066874 , 13.57406884, 12.34820597,
        11.22213442, 10.79480165, 10.19911148,  9.43738339,  8.65153409,
        10.13202568,  9.23026889,  8.34379998,  7.59273782,  7.02043792,
        7.59966392,  8.57733816,  8.12912603, 14.62444472, 13.40237849,
        12.26371512, 11.20588153, 16.50109118, 28.01589467, 23.29544755,
        20.30596278, 16.29131353, 13.65525305, 13.08456347, 11.09341275,
        10.50692447,  9.48213145, 13.92941996, 12.78172674, 13.58201465,
        12.29941353, 12.74053942, 14.02936805, 15.10801004, 13.13423495,
        12.40651749, 11.34282051]

        self.adx_period_6_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        73.76782014, 76.41654278, 78.83164022, 70.76045107, 57.69017918,
        55.76448404, 55.70895193, 50.82380268, 43.06241038, 34.51272381,
        36.66416226, 39.76401887, 45.37515422, 47.89399657, 52.20101789,
        55.78567267, 50.47144949, 43.447372  , 36.28329945, 32.03916018,
        29.08341871, 24.61172374, 20.91044057, 21.65838335, 19.14705308,
        17.57621837, 18.50188508, 24.61275979, 22.01919342, 19.36474044,
        22.45682324, 25.94918316, 25.29108759, 22.93488111, 20.87584473,
        17.6415762 , 19.1667842 , 21.23044453, 24.77111471, 26.49670987,
        29.02499039, 32.49661081, 36.62817734, 34.23871271, 31.07858091,
        30.06724666, 26.41218477, 26.3727615 , 26.83603916, 27.5722316 ,
        23.68132182, 21.43513024, 18.58833262, 20.44069951, 20.48283681,
        20.93453441, 20.08178823, 20.69351214, 18.22245218, 17.41834785,
        17.58926777, 17.85637572, 17.52372151, 19.13006583, 20.75222451,
        19.1155327 , 20.09745801, 22.42298075, 22.6953171 , 20.29240626,
        22.97414377, 25.90135997, 21.95486869, 22.88763239, 21.08486333,
        21.23750624, 21.49007493, 19.3558743 , 19.8286899 , 20.85947667,
        20.7205471 , 17.88612705, 17.29700051, 17.64810224, 16.12432329,
        14.26610926, 13.14827215, 14.61406508, 18.31401109, 22.91808104,
        22.06930476, 24.16627104, 26.59723404, 29.41446476, 32.17752621,
        31.39615891, 27.37089263, 25.53940518, 28.04501144, 27.92284562,
        26.63503405, 23.89666922, 27.94529684, 36.43439039, 43.82937485,
        50.39552658, 55.86731968, 58.99014215, 62.30680495, 62.04167517,
        62.70760415, 63.43156065, 66.74146724, 69.32380835, 72.08319131,
        71.44697231, 71.88789007, 73.44151466, 75.60375131, 75.6606507 ,
        76.16883479, 71.34963535]

        self.adx_period_8_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        np.nan, np.nan, 82.69213454, 69.80705958, 55.82647992,
        54.83656041, 55.36468478, 51.55411247, 41.38384671, 34.97347929,
        34.98439365, 36.28084667, 40.26616688, 42.127769  , 45.58452836,
        48.51381184, 45.55932571, 39.39211184, 34.46321387, 31.64830476,
        29.57273494, 25.99806974, 22.93195936, 22.92678291, 20.10487131,
        18.87403035, 19.10614935, 22.77325335, 21.28418192, 18.75669215,
        20.13043706, 21.97302364, 21.53242928, 19.79757988, 18.22974465,
        16.12435877, 16.78101408, 17.84181442, 19.9020043 , 21.06669165,
        22.72743794, 25.00612435, 27.78298761, 27.20326774, 26.06784621,
        25.90252254, 24.28124157, 22.96337838, 22.12373876, 21.60414275,
        18.99800901, 17.25159901, 15.65375606, 16.27889175, 16.07428692,
        16.127342  , 15.58886986, 15.80492311, 14.58343231, 14.12829274,
        13.70243515, 13.39788039, 13.21635705, 14.06261384, 14.97505552,
        14.05153777, 14.64512764, 16.08955434, 16.48885403, 15.45781253,
        17.24481153, 19.23381197, 17.48921451, 18.37385813, 16.9340164 ,
        16.71778023, 16.60602661, 15.43325627, 15.72736702, 16.35950174,
        16.39802988, 15.01685133, 14.72959512, 14.91879057, 14.19136097,
        12.41770032, 11.08462366, 11.16793701, 12.65114051, 14.88571613,
        14.67321918, 16.05708448, 17.66810701, 19.54067794, 21.42077435,
        21.67787049, 20.28569225, 19.78605608, 20.70130105, 20.38474956,
        19.51191693, 17.9166967 , 20.36828544, 26.56789383, 32.28248418,
        37.64437878, 42.33603538, 45.65883688, 49.0636794 , 50.41059667,
        52.09043544, 53.65587457, 56.77735466, 59.41012318, 62.15288011,
        62.93155355, 64.16287414, 65.97074505, 68.14552662, 69.05307004,
        70.11548496, 68.07503858]

        self.adx_period_10_expected =  [ np.nan, np.nan, np.nan, np.nan, np.nan,
        np.nan, np.nan, np.nan, np.nan, 37.94785935,
        46.57307644, 50.80545905, 48.20574644, 37.59518728, 32.30825637,
        31.43168004, 32.10693775, 35.66083635, 37.32914545, 40.52791046,
        43.21105069, 41.18843088, 36.04236479, 32.33306404, 30.19041194,
        28.58875108, 25.89084586, 23.55168652, 23.32807871, 20.8873562 ,
        19.82123798, 19.78076851, 22.2884113 , 21.20658549, 19.06610814,
        19.59454012, 20.56258015, 20.04208764, 18.63795538, 17.34807637,
        15.66872117, 15.88717513, 16.42487071, 17.70485646, 18.4523997 ,
        19.56085336, 21.1242161 , 23.07701907, 22.98233059, 22.50398122,
        22.59106158, 21.76138885, 20.28787214, 19.17586556, 18.31954621,
        16.64868768, 15.1315492 , 14.1494444 , 14.18214204, 13.77051304,
        13.54816133, 13.01561782, 12.95676039, 12.11001027, 11.70973667,
        11.30103224, 10.97437472, 10.76824683, 11.2615787 , 11.81767739,
        11.18012765, 11.52358641, 12.4499539 , 12.76654715, 12.22021771,
        13.46948218, 14.88079343, 14.00077233, 14.77488781, 13.69920745,
        13.44496244, 13.268603  , 12.59577337, 12.85891054, 13.34296414,
        13.46430895, 12.70694118, 12.59148319, 12.7585546 , 12.38244107,
        11.36613567, 10.32075872,  9.94677331, 10.49049744, 11.58699292,
        11.37245647, 12.16703836, 13.14006506, 14.31358073, 15.52434512,
        15.86810354, 15.282334  , 15.16686456, 15.56820543, 15.28118249,
        14.67758205, 13.65378998, 15.25789873, 19.91262204, 24.35696606,
        28.67500183, 32.56121637, 35.5716483 , 38.66957743, 40.44753227,
        42.394818  , 44.213473  , 47.15908364, 49.74761149, 52.42765661,
        53.81826799, 55.44956593, 57.44720013, 59.70284513, 61.0898195 ,
        62.52586245, 61.90667742]

    def test_positive_directional_movement(self):
        pdm = directional_indicators.positive_directional_movement(self.high_data, self.low_data)
        np.testing.assert_allclose(pdm, self.positive_directional_movement_expected)

    def test_negative_directional_movement(self):
        ndm = directional_indicators.negative_directional_movement(self.high_data, self.low_data)
        np.testing.assert_allclose(ndm, self.negative_directional_movement_expected)

    def test_pdi_period_6(self):
        period = 6
        pdi = directional_indicators.positive_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(pdi, self.pdi_period_6_expected)

    def test_pdi_period_8(self):
        period = 8
        pdi = directional_indicators.positive_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(pdi, self.pdi_period_8_expected)

    def test_pdi_period_10(self):
        period = 10
        pdi = directional_indicators.positive_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(pdi, self.pdi_period_10_expected)

    def test_pdi_invalid_period(self):
        period = 128
        with self.assertRaises(Exception) as cm:
            directional_indicators.positive_directional_index(self.close_data, self.high_data, self.low_data, period)
        expected = "Error: data_len < period"
        self.assertEqual(str(cm.exception), expected)

    def test_pdi_invalid_data(self):
        period = 6
        self.close_data.append(0)
        with self.assertRaises(Exception) as cm:
            directional_indicators.positive_directional_index(self.close_data, self.high_data, self.low_data, period)
        expected = ("Error: mismatched data lengths, check to ensure that all input data is the same length and valid")
        self.assertEqual(str(cm.exception), expected)

    def test_ndi_period_6(self):
        period = 6
        ndi = directional_indicators.negative_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(ndi, self.ndi_period_6_expected)

    def test_ndi_period_8(self):
        period = 8
        ndi = directional_indicators.negative_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(ndi, self.ndi_period_8_expected)

    def test_ndi_period_10(self):
        period = 10
        ndi = directional_indicators.negative_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(ndi, self.ndi_period_10_expected)

    def test_ndi_invalid_period(self):
        period = 128
        with self.assertRaises(Exception) as cm:
            directional_indicators.negative_directional_index(self.close_data, self.high_data, self.low_data, period)
        expected = "Error: data_len < period"
        self.assertEqual(str(cm.exception), expected)

    def test_ndi_invalid_data(self):
        period = 6
        self.close_data.append(0)
        with self.assertRaises(Exception) as cm:
            directional_indicators.negative_directional_index(self.close_data, self.high_data, self.low_data, period)
        expected = ("Error: mismatched data lengths, check to ensure that all input data is the same length and valid")
        self.assertEqual(str(cm.exception), expected)

    def test_adx_period_6(self):
        period = 6
        adx = directional_indicators.average_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(adx, self.adx_period_6_expected)

    def test_adx_period_8(self):
        period = 8
        adx = directional_indicators.average_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(adx, self.adx_period_8_expected)

    def test_adx_period_10(self):
        period = 10
        adx = directional_indicators.average_directional_index(self.close_data, self.high_data, self.low_data, period)
        np.testing.assert_allclose(adx, self.adx_period_10_expected)

    def test_adx_invalid_period(self):
        period = 128
        with self.assertRaises(Exception) as cm:
            directional_indicators.average_directional_index(self.close_data, self.high_data, self.low_data, period)
        expected = "Error: data_len < period"
        self.assertEqual(str(cm.exception), expected)

    def test_adx_invalid_data(self):
        period = 6
        self.close_data.append(0)
        with self.assertRaises(Exception) as cm:
            directional_indicators.average_directional_index(self.close_data, self.high_data, self.low_data, period)
        expected = ("Error: mismatched data lengths, check to ensure that all input data is the same length and valid")
        self.assertEqual(str(cm.exception), expected)
